import json

# Load local deployed bytecode from Hardhat/Foundry artifact
with open(r"artifacts/contracts/KustodiaEscrow.sol/KustodiaEscrow.json", "r") as f:
    artifact = json.load(f)
local_bytecode = artifact["deployedBytecode"].lstrip("0x")

# Paste the deployed bytecode from Arbiscan here (no 0x prefix)
arbiscan_bytecode = """
608060405234801562000010575f80fd5b50604051620020de380380620020de83398181016040528101906200003691906200020b565b620000566200004a620000de60201b60201c565b620000e560201b60201c565b8160015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508060025f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550505062000250565b5f33905090565b5f805f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f620001d582620001aa565b9050919050565b620001e781620001c9565b8114620001f2575f80fd5b50565b5f815190506200020581620001dc565b92915050565b5f8060408385031215620002245762000223620001a6565b5b5f6200023385828601620001f5565b92505060206200024685828601620001f5565b9150509250929050565b611e80806200025e5f395ff3fe608060405234801561000f575f80fd5b50600436106100b2575f3560e01c80639526592f1161006f5780639526592f1461016b578063a5c1674e14610187578063bf333f2c146101a3578063c7ceafea146101c1578063f2fde38b146101df578063fa2af9da146101fb576100b2565b8063012f52ee146100b65780631bd80eca146100ed57806334b25ee2146101095780634043cd9514610125578063715018a6146101435780638da5cb5b1461014d575b5f80fd5b6100d060048036038101906100cb9190611277565b610219565b6040516100e4989796959493929190611363565b60405180910390f35b61010760048036038101906101029190611409565b6102a7565b005b610123600480360381019061011e91906114a2565b610897565b005b61012d610ba2565b60405161013a919061153b565b60405180910390f35b61014b610bc7565b005b610155610bda565b6040516101629190611554565b60405180910390f35b61018560048036038101906101809190611277565b610c01565b005b6101a1600480360381019061019c9190611277565b610e6d565b005b6101ab611048565b6040516101b8919061156d565b60405180910390f35b6101c961104d565b6040516101d6919061156d565b60405180910390f35b6101f960048036038101906101f49190611586565b611053565b005b6102036110d5565b6040516102109190611554565b60405180910390f35b6004602052805f5260405f205f91509050805f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806002015490806003015490806004015490806005015490806006015490806007015f9054906101000a900460ff16905088565b60648211156102eb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102e29061160b565b60405180910390fd5b5f831161032d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161032490611673565b60405180910390fd5b5f61271060968561033e91906116be565b610348919061172c565b90505f6064848661035991906116be565b610363919061172c565b90505f828287610373919061175c565b61037d919061175c565b905060015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166323b872dd3330896040518463ffffffff1660e01b81526004016103dd9392919061178f565b6020604051808303815f875af11580156103f9573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061041d91906117d8565b61045c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104539061184d565b60405180910390fd5b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60025f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16856040518363ffffffff1660e01b81526004016104d992919061186b565b6020604051808303815f875af11580156104f5573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061051991906117d8565b610558576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161054f906118dc565b60405180910390fd5b5f8111156106785760015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb88836040518363ffffffff1660e01b81526004016105bc92919061186b565b6020604051808303815f875af11580156105d8573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906105fc91906117d8565b61063b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161063290611944565b60405180910390fd5b6003547f665b96d856d26c8313c8c7e2ca7fdfc4c3add392a1e2ea3fe22a46aba0a4aec7828960405161066f929190611962565b60405180910390a25b6040518061010001604052803373ffffffffffffffffffffffffffffffffffffffff1681526020018873ffffffffffffffffffffffffffffffffffffffff16815260200187815260200183815260200182815260200184815260200185426106e09190611989565b81526020015f60048111156106f8576106f76112f0565b5b81525060045f60035481526020019081526020015f205f820151815f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506020820151816001015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020155606082015181600301556080820151816004015560a0820151816005015560c0820151816006015560e0820151816007015f6101000a81548160ff021916908360048111156107f4576107f36112f0565b5b02179055509050508673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff166003547f4e588f7e594f40d61570fb5e07e32a20b4f4fc82f277d168621ec77a6207342f898686898b4261085e9190611989565b60405161086f9594939291906119bc565b60405180910390a460035f81548092919061088990611a0d565b919050555050505050505050565b61089f6110fa565b5f60045f8481526020019081526020015f209050600260048111156108c7576108c66112f0565b5b816007015f9054906101000a900460ff1660048111156108ea576108e96112f0565b5b1461092a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161092190611a9e565b60405180910390fd5b6003816007015f6101000a81548160ff02191690836004811115610951576109506112f0565b5b02179055508115610a635760015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb826001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1683600301546040518363ffffffff1660e01b81526004016109df92919061186b565b6020604051808303815f875af11580156109fb573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610a1f91906117d8565b610a5e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a5590611b06565b60405180910390fd5b610b65565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb825f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1683600301546040518363ffffffff1660e01b8152600401610ae592919061186b565b6020604051808303815f875af1158015610b01573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610b2591906117d8565b610b64576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b5b90611b6e565b60405180910390fd5b5b827f5a87909bff68caaaaf0b3fd9c74eeccc928832f879315e5c6fb7a73612f26c0c83604051610b959190611b9b565b60405180910390a2505050565b60015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1681565b610bcf6110fa565b610bd85f611178565b565b5f805f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b610c096110fa565b5f60045f8381526020019081526020015f2090505f6004811115610c3057610c2f6112f0565b5b816007015f9054906101000a900460ff166004811115610c5357610c526112f0565b5b14610c93576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c8a90611bfe565b60405180910390fd5b8060060154421015610cda576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610cd190611c66565b60405180910390fd5b6001816007015f6101000a81548160ff02191690836004811115610d0157610d006112f0565b5b021790555060015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb826001015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1683600301546040518363ffffffff1660e01b8152600401610d8992919061186b565b6020604051808303815f875af1158015610da5573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610dc991906117d8565b610e08576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610dff90611cce565b60405180910390fd5b817f1ab7e153e445011096686e7d6cdde884e5b3a4c5c1e49b1087e4a64d6850e1308260030154836001015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff16604051610e61929190611962565b60405180910390a25050565b5f60045f8381526020019081526020015f209050805f015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161480610f2b5750806001015f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b610f6a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f6190611d36565b60405180910390fd5b5f6004811115610f7d57610f7c6112f0565b5b816007015f905490610100a900460ff166004811115610fa057610f9f6112f0565b5b14610fe0576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fd790611bfe565b60405180910390fd5b6002816007015f610100a90048160ff02191690836004811115611007576110066112f0565b5b0217905550817f84a477df8a28a4276ca6dee4458a06c3015f30c477d9c949ede4e13ff8a552b43360405161103c9190611554565b60405180910390a25050565b609681565b60035481565b61105b6110fa565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036110c9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016110c090611dc4565b60405180910390fd5b6110d281611178565b50565b60025f905490610100a900473ffffffffffffffffffffffffffffffffffffffff1681565b611102611239565b73ffffffffffffffffffffffffffffffffffffffff16611120610bda565b73ffffffffffffffffffffffffffffffffffffffff1614611176576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161116d90611e2c565b60405180910390fd5b565b5f805f905490610100a900473ffffffffffffffffffffffffffffffffffffffff169050815f806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f33905090565b5f80fd5b5f819050919050565b61125681611244565b8114611260575f80fd5b50565b5f813590506112718161124d565b92915050565b5f6020828403121561128c5761128b611240565b5b5f61129984828501611263565b91505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6112cb826112a2565b9050919050565b6112db816112c1565b82525050565b5f610100820190506113775f83018b6112d2565b611384602083018a6112d2565b61139160408301896112e1565b61139e60608301886112e1565b6113ab60808301876112e1565b6113b860a08301866112e1565b6113c560c08301856112e1565b6113d260e0830184611354565b9998505050505050505050565b6113e8816112c1565b81146113f2575f80fd5b50565b5f81359050611403816113df565b92915050565b5f805f806080858703121561142157611420611240565b5b5f61142e878288016113f5565b945050602061143f87828801611263565b935050604061145087828801611263565b925050606061146187828801611263565b91505092959194509250565b5f8115159050919050565b6114818161146d565b811461148b575f80fd5b50565b5f8135905061149c81611478565b92915050565b5f80604083850312156114b8576114b7611240565b5b5f6114c585828601611263565b92505060206114d68582860161148e565b9150509250929050565b5f819050919050565b5f6115036114fe6114f9846112a2565b6114e0565b6112a2565b9050919050565b5f611514826114e9565b9050919050565b5f6115258261150a565b9050919050565b6115358161151b565b82525050565b5f60208201905061154e5f83018461152c565b92915050565b5f6020820190506115675f8301846112d2565b92915050565b5f6020820190506115805f8301846112e1565b92915050565b5f6020828403121561159b5761159a611240565b5b5f6115a8848285016113f5565b91505092915050565b5f82825260208201905092915050565b7f496e76616c696420637573746f64792070657263656e740000000000000000005f82015250565b5f6115f56017836115b1565b9150611600826115c1565b602082019050919050565b5f6020820190508181035f830152611622816115e9565b9050919050565b7f416d6f756e74206d757374206265203e203000000000000000000000000000005f82015250565b5f61165d6012836115b1565b915061166882611629565b602082019050919050565b5f6020820190508181035f83015261168a81611651565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6116c882611244565b91506116d383611244565b92508282026116e181611244565b915082820484148315176116f8576116f7611691565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f61173682611244565b915061174183611244565b925082611751576117506116ff565b5b828204905092915050565b5f61176682611244565b915061177183611244565b925082820390508181111561178957611788611691565b5b92915050565b5f6060820190506117a25f8301866112d2565b6117af60208301856112d2565b6117bc60408301846112e1565b949350505050565b5f815190506117d281611478565b92915050565b5f602082840312156117ed576117ec611240565b5b5f6117fa848285016117c4565b91505092915050565b7f546f6b656e207472616e73666572206661696c656400000000000000000000005f82015250565b5f6118376015836115b1565b915061184282611803565b602082019050919050565b5f6020820190508181035f8301526118648161182b565b9050919050565b5f60408201905061187e5f8301856112d2565b61188b60208301846112e1565b9392505050565b7f466565207472616e73666572206661696c6564000000000000000000000000005f82015250565b5f6118c66013836115b1565b91506118d182611892565b602082019050919050565b5f6020820190508181035f8301526118f3816118ba565b9050919050565b7f496d6d6564696174652072656c65617365206661696c656400000000000000005f82015250565b5f61192e6018836115b1565b9150611939826118fa565b602082019050919050565b5f6020820190508181035f83015261195b81611922565b9050919050565b5f6040820190506119755f8301856112e1565b61198260208301846112d2565b9392505050565b5f61199382611244565b915061199e83611244565b92508282019050808211156119b6576119b5611691565b5b92915050565b5f60a0820190506119cf5f8301886112e1565b6119dc60208301876112e1565b6119e960408301866112e1565b611a0360808301846112e1565b9695505050505050565b5f611a1782611244565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203611a4957611a48611691565b5b600182019050919050565b7f4e6f7420646973707574656400000000000000000000000000000000000000005f82015250565b5f611a88600c836115b1565b9150611a9382611a54565b602082019050919050565b5f6020820190508181035f830152611ab581611a7c565b9050919050565b7f52656c65617365206661696c65640000000000000000000000000000000000005f82015250565b5f611af0600e836115b1565b9150611afb82611abc565b602082019050919050565b5f6020820190508181035f830152611b1d81611ae4565b9050919050565b7f526566756e64206661696c6564000000000000000000000000000000000000005f82015250565b5f611b58600d836115b1565b9150611b6382611b24565b602082019050919050565b5f6020820190508181035f830152611b8581611b4c565b9050919050565b611b958161146d565b82525050565b5f602082019050611bae5f830184611b8c565b92915050565b7f4e6f7420616374697665000000000000000000000000000000000000000000005f82015250565b5f611be8600a836115b1565b9150611bf382611bb4565b602082019050919050565b5f6020820190508181035f830152611c1581611bdc565b9050919050565b7f437573746f647920706572696f64206e6f7420656e64656400000000000000005f82015250565b5f611c506018836115b1565b9150611c5b82611c1c565b602082019050919050565b5f6020820190508181035f830152611c7d81611c44565b9050919050565b7f437573746f64792072656c65617365206661696c6564000000000000000000005f82015250565b5f611cb86016836115b1565b9150611cc382611c84565b602082019050919050565b5f6020820190508181035f830152611ce581611cac565b9050919050565b7f4e6f74207061727469636970616e7400000000000000000000000000000000005f82015250565b5f611d20600f836115b1565b9150611d2b82611cec565b602082019050919050565b5f6020820190508181035f830152611d4d81611d14565b9050919050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f20615f8201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b5f611dae6026836115b1565b9150611db982611d54565b604082019050919050565b5f6020820190508181035f830152611ddb81611da2565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65725f82015250565b5f611e166020836115b1565b9150611e2182611de2565b602082019050919050565b5f6020820190508181035f830152611e4381611e0a565b905091905056fe{ipfs}64736f6c63430008140033
""".replace("\n", "")

# Compare the bytecodes
min_len = min(len(local_bytecode), len(arbiscan_bytecode))
for i in range(min_len):
    if local_bytecode[i] != arbiscan_bytecode[i]:
        print(f"Mismatch at position {i}: local='{local_bytecode[i]}' vs arbiscan='{arbiscan_bytecode[i]}'")
        print(f"Local:     {local_bytecode[max(0,i-20):i+20]}")
        print(f"Arbiscan:  {arbiscan_bytecode[max(0,i-20):i+20]}")
        break
else:
    if len(local_bytecode) == len(arbiscan_bytecode):
        print("Bytecodes match exactly!")
    else:
        print(f"Bytecodes are the same for the first {min_len} characters but lengths differ: local={len(local_bytecode)}, arbiscan={len(arbiscan_bytecode)}")
