ðŸš€ HEROKU CLI MIGRATION COMMANDS

1. Connect to production database:
heroku pg:psql --app kustodia-backend

2. Once connected, run these SQL commands one by one:

-- Check current status first:
SELECT p.id, p.status, p.payer_approval, p.payee_approval, e.status as escrow_status, e.release_tx_hash FROM payment p LEFT JOIN escrow e ON p.id = e.payment_id WHERE p.id IN (112, 113);

-- Payment 112 Migration:
BEGIN;
UPDATE payment SET status = 'completed', payer_approval = true, payee_approval = true, updated_at = NOW() WHERE id = 112;
UPDATE escrow SET status = 'completed', release_tx_hash = '0x1917e76262e46cd27aa80cf702e1ae204f0c37936ce9c45e115298ac4e1cd35d', smart_contract_escrow_id = '9', updated_at = NOW() WHERE payment_id = 112;
INSERT INTO payment_event (payment_id, type, description, is_automatic, created_at) VALUES (112, 'production_migration', 'Estado migrado desde desarrollo - Payment 112 completado', true, NOW());
COMMIT;

-- Payment 113 Migration:
BEGIN;
UPDATE payment SET status = 'completed', payer_approval = true, payee_approval = true, updated_at = NOW() WHERE id = 113;
UPDATE escrow SET status = 'completed', release_tx_hash = '0x41da5b7d6b5f08596c04c798409723e20361acd25430b0f058b7e6970fa38531', smart_contract_escrow_id = '10', updated_at = NOW() WHERE payment_id = 113;
INSERT INTO payment_event (payment_id, type, description, is_automatic, created_at) VALUES (113, 'production_migration', 'Estado migrado desde desarrollo - Payment 113 completado', true, NOW());
COMMIT;

-- Verify results:
SELECT p.id, p.status, p.payer_approval, p.payee_approval, e.status as escrow_status, e.release_tx_hash FROM payment p LEFT JOIN escrow e ON p.id = e.payment_id WHERE p.id IN (112, 113);

3. Type \q to exit psql
